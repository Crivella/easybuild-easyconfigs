# Thomas Hoffmann, EMBL Heidelberg, structures-it@embl.de, 2025/01
easyblock = 'CMakeMake'

name = 'mrc'
version = '1.3.13'

homepage = 'https://github.com/mhekkel/mrc'
description = """A long, long time ago there existed an operating system that did things         
differently. One of the cool features of this OS was that applications were self
contained. A single file was everything you needed to copy in order to install  
a new application instead of having to use installers or install scripts that   
put dozens of files at the most obscure locations on your disk.

One of the technical features of this OS to make this possible was what they    
called resources. In fact, resources were stored as some kind of database in one
of the two forks of a file, the other fork being the data fork.

Resources were mildly popular, other OS'es copied the concept in one way or     
another. The company that invented them abandoned the whole concept though, they
thought they had something better....

Anyway, I still like being able to provide a single executable to the users of  
my software. And given the usefulness of resources I decided to create a        
compiler for them that works with the ELF executable format. Since using        
resource forks is not an option I decided to store the data in the static data  
section of an executable. The data is then available through global variables.
"""

toolchain = {'name': 'GCCcore', 'version': '13.3.0'}

source_urls = [GITHUB_SOURCE]
sources = ['v%(version)s.tar.gz']
patches = ['mrc-1.3.13_relax_libmcfp_version.patch']
checksums = [
    {'v1.3.13.tar.gz': 'cf93dba0d4fb6c5908a69927eac5738d0a8fa621886e8933c429618649db4d5e'},
    {'mrc-1.3.13_relax_libmcfp_version.patch': '024ec3b03ef74d7a8716ad93e4ae240d5c5c53b0487910f48956bd6f311f57d4'},
]

github_account = 'mhekkel'

configopts = '-DFETCHCONTENT_FULLY_DISCONNECTED=ON '

builddependencies = [
    ('binutils', '2.42'),
    ('CMake', '3.29.3'),
    ('libmcfp', '1.3.4'),
    ('Catch2', '3.8.0')  # req. 3.5.2 or newer
]

sanity_check_commands = ['mrc -h']
sanity_check_paths = {
    'files': ['bin/mrc'],
    'dirs': ['bin']
}

moduleclass = 'tools'
