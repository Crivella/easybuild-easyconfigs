easyblock = 'CargoPythonPackage'

name = 'tlparse'
version = '0.3.5'

homepage = 'https://github.com/ezyang/tlparse'
description = "Parse structured PT2 (PyTorch 2) logs"

toolchain = {'name': 'GCCcore', 'version': '13.2.0'}

github_account = 'ezyang'
source_urls = [GITHUB_SOURCE]
sources = ['v%(version)s.tar.gz']
checksums = ['256eb651bc435c75ff33ad4a31695db99e7e8441d45d2a3124c66fbe2a4b1d30']

builddependencies = [
    ('binutils', '2.40'),
    ('maturin', '1.5.0', '-Rust-1.76.0'),
]

dependencies = [
    ('Python', '3.11.5'),
]

use_pip = True
sanity_pip_check = True
download_dep_fail = True

options = {
    'modulename': False,
}

crates = [
    ('aho-corasick', '1.1.2'),
    ('anstream', '0.6.13'),
    ('anstyle', '1.0.6'),
    ('anstyle-parse', '0.2.3'),
    ('anstyle-query', '1.0.2'),
    ('anstyle-wincon', '3.0.2'),
    ('base16ct', '0.2.0'),
    ('block-buffer', '0.10.4'),
    ('bstr', '1.9.1'),
    ('byteorder', '1.5.0'),
    ('cfg-if', '1.0.0'),
    ('clap', '4.5.1'),
    ('clap_builder', '4.5.1'),
    ('clap_derive', '4.5.0'),
    ('clap_lex', '0.7.0'),
    ('colorchoice', '1.0.0'),
    ('console', '0.15.8'),
    ('crypto-common', '0.1.6'),
    ('digest', '0.10.7'),
    ('encode_unicode', '0.3.6'),
    ('equivalent', '1.0.1'),
    ('fxhash', '0.2.1'),
    ('generic-array', '0.14.7'),
    ('hashbrown', '0.14.3'),
    ('heck', '0.4.1'),
    ('html-escape', '0.2.13'),
    ('indexmap', '2.2.3'),
    ('indicatif', '0.17.8'),
    ('instant', '0.1.12'),
    ('itoa', '1.0.10'),
    ('lazy_static', '1.4.0'),
    ('libc', '0.2.153'),
    ('md-5', '0.10.6'),
    ('memchr', '2.7.1'),
    ('normpath', '1.2.0'),
    ('number_prefix', '0.4.0'),
    ('once_cell', '1.19.0'),
    ('opener', '0.6.1'),
    ('portable-atomic', '1.6.0'),
    ('proc-macro2', '1.0.78'),
    ('quote', '1.0.35'),
    ('regex', '1.10.3'),
    ('regex-automata', '0.4.5'),
    ('regex-syntax', '0.8.2'),
    ('ryu', '1.0.17'),
    ('serde', '1.0.197'),
    ('serde_derive', '1.0.197'),
    ('serde_json', '1.0.114'),
    ('strsim', '0.11.0'),
    ('syn', '2.0.51'),
    ('tinytemplate', '1.2.1'),
    ('typenum', '1.17.0'),
    ('unicode-ident', '1.0.12'),
    ('unicode-width', '0.1.11'),
    ('utf8-width', '0.1.7'),
    ('utf8parse', '0.2.1'),
    ('version_check', '0.9.4'),
    ('winapi', '0.3.9'),
    ('winapi-i686-pc-windows-gnu', '0.4.0'),
    ('winapi-x86_64-pc-windows-gnu', '0.4.0'),
    ('windows-sys', '0.52.0'),
    ('windows-targets', '0.52.3'),
    ('windows_aarch64_gnullvm', '0.52.3'),
    ('windows_aarch64_msvc', '0.52.3'),
    ('windows_i686_gnu', '0.52.3'),
    ('windows_i686_msvc', '0.52.3'),
    ('windows_x86_64_gnu', '0.52.3'),
    ('windows_x86_64_gnullvm', '0.52.3'),
    ('windows_x86_64_msvc', '0.52.3'),
]

sanity_check_paths = {
    'files': ['bin/tlparse'],
    'dirs': [],
}

sanity_check_commands = [
    'tlparse --version',
]

moduleclass = 'tools'
