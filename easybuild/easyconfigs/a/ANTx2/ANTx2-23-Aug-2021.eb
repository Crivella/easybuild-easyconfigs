# #
# This is a contribution from HPCNow! (http://hpcnow.com)
# Copyright::   HPCNow!
# Authors::     Jordi Blasco <jordi.blasco@hpcnow.com>
# License::     GPL-v3.0
# #

easyblock = "PackedBinary"

name = 'ANTx2'
version = '23-Aug-2021'

homepage = 'https://github.com/ChariteExpMri/antx2'
description = """ ANTx2 stands for A tlas N ormalization T oolbox using elasti x.
It is a MATLAB toolbox for image registration of mouse magnetic resonance imaging data
developed for research laboratories/departments. The pipeline works with invivo or
exvivo (skull-stripped) MR-data for the following species: mouse, rat, Etruscan
shrew and cat. """

toolchain = SYSTEM

source_urls = ['https://github.com/ChariteExpMri/antx2/archive/']
sources = [{'download_filename': 'f6597aac10.tar.gz', 'filename': SOURCE_TAR_GZ}]
checksums = ['ff21815e5f950d8a621f7d8dfe6351c3c373e2e354c81b8694afb478367a5ad4']

postinstallcmds = [
    'chmod +x %(installdir)s/mritools/elastix/elastix_linux64_v4.7/bin/elastix',
    'chmod +x %(installdir)s/mritools/elastix/elastix_linux64_v4.7/bin/transformix',
]

modextrapaths = {
    'PATH': ['', 'mritools/elastix/elastix_linux64_v4.7/bin'],
    'LD_LIBRARY_PATH': 'mritools/elastix/elastix_linux64_v4.7/lib',
    'LIBRARY_PATH': 'mritools/elastix/elastix_linux64_v4.7/lib',
}

sanity_check_paths = {
    'files': ["__startup.m", "antver.m", "mritools/ant/ant.m", "mritools/elastix/elastix_linux64_v4.7/bin/elastix",
              "mritools/elastix/elastix_linux64_v4.7/bin/transformix",
              "mritools/elastix/elastix_linux64_v4.7/lib/libANNlib.so"],
    'dirs': ["mritools", "mricron", "spm12"]
}

moduleclass = 'bio'
