easyblock = 'CMakeMake'

name = 'Ginkgo'
version = '1.9.0'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://github.com/ginkgo-project/ginkgo'
description = "Ginkgo is a high-performance numerical linear algebra library with a focus on the solution of sparse linear systems"

toolchain = {'name': 'gompi', 'version': '2023b'}
toolchainopts = {'openmp': True, 'usempi': True}

source_urls = ['https://github.com/ginkgo-project/ginkgo/archive/refs/tags/v%(version)s']
sources = ['v%(version)s.tar.gz']
checksums = ['18271e99f81a89cf27102f9d4e84653ae7a0cc745fcda9a7ed486c455553780b']

builddependencies = [
    ('CMake', '3.27.6')
]

dependencies = [('CUDA', '12.6.0')]

configopts = '-DGINKGO_BUILD_MPI=ON -DGINKGO_BUILD_CUDA=ON -DGINKGO_BUILD_OMP=ON -DGINKGO_FAST_TESTS=ON'

build_shared_libs = True

runtest = 'test'

sanity_check_paths = {
    'files': ['lib/libginkgo.%s' % SHLIB_EXT, 'lib/libginkgo_device.%s' % SHLIB_EXT],
    'dirs': ['include/ginkgo', 'lib/cmake'],
}

moduleclass = 'numlib'
